<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.26">

  <title>Introduction to Data Science – Unsupervised Learning with K-Means</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-a39843259aa5179dad24436622ef3209.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Unsupervised Learning with K-Means</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="plan-for-the-rest-of-the-quarter" class="title-slide slide level1 center">
<h1>Plan for the rest of the quarter</h1>

</section>
<section id="weeks-8-9-10" class="slide level2">
<h2>Weeks 8, 9, &amp; 10</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="fragment">
<p><strong>Week 8</strong></p>
<ul>
<li>Last week of models!
<ul>
<li>Statistical Learning Model: K-Means<br>
</li>
<li>Data Model: Joins</li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><strong>Week 9</strong></p>
<ul>
<li>Data Ethics
<ul>
<li>Data Context</li>
<li>Model Ethics</li>
</ul></li>
<li>Project Work Sessions</li>
</ul>
</div>
</div><div class="column" style="width:30%;">
<div class="fragment">
<p><strong>Week 10</strong></p>
<ul>
<li>Final Posters</li>
<li>Practice Final</li>
<li>Exam 2</li>
</ul>
</div>
</div></div>
</section></section>
<section>
<section id="the-story-so-far" class="title-slide slide level1 center">
<h1>The story so far…</h1>

</section>
<section id="predictive-modeling" class="slide level2">
<h2>Predictive Modeling</h2>
<div class="midi">
<ul>
<li class="fragment"><p>In <strong>predictive modeling</strong>, a.k.a. <strong>supervised machine learning</strong>, we have a <strong>target variable</strong> we want to predict.</p></li>
<li class="fragment"><p>We expect to have observations where we know the <em>predictors</em> but not the <em>target</em>.</p></li>
<li class="fragment"><p>Our goal is to choose a <strong>modeling procedure</strong> to guess the value of the target variable based on the predictors.</p></li>
<li class="fragment"><p>We use <strong>cross-validation</strong> to estimate the <strong>test error</strong> of various procedure options.</p></li>
<li class="fragment"><p>We might compare different:</p></li>
</ul>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:47%;">
<div class="small">
<ol type="1">
<li>feature sets</li>
<li>preprocessing choices</li>
</ol>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:47%;">
<div class="small">
<ol start="3" type="1">
<li>model specifications / algorithms</li>
<li>tuning parameters</li>
</ol>
</div>
</div></div>
</div>
</section></section>
<section>
<section id="unsupervised-learning" class="title-slide slide level1 center">
<h1>Unsupervised Learning</h1>

</section>
<section id="unsupervised-learning-1" class="slide level2">
<h2>Unsupervised Learning</h2>
<ul>
<li class="fragment"><p>In <strong>unsupervised</strong> situations, we <strong><em>do not</em></strong> have a target variable <span class="math inline">\(y\)</span>.</p></li>
<li class="fragment"><p>We <em>do</em> still have <strong>features</strong> that we observe.</p></li>
<li class="fragment"><p>Our goal: Find an <em>interesting structure</em> in the features we have.</p></li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Supervised vs Unsupervised</strong></p>
</div>
<div class="callout-content">
<p>Think of children playing with Legos. They might be <em>supervised</em> by parents who help them follow instructions, or they might be left alone to build whatever they want!</p>
</div>
</div>
</div>
</div>
</section>
<section id="clustering" class="slide level2">
<h2>Clustering</h2>
<div class="midi">
<ul>
<li class="fragment"><p>Nearly all unsupervised learning algorithms can be called <strong><em>clustering</em></strong>.</p></li>
<li class="fragment"><p>The goal is to use the <strong>observed features</strong> (columns) to sort the <strong>observations</strong> (rows) into similar <strong>clusters</strong> (groups).</p></li>
<li class="fragment"><p>For example: Suppose I take all of your grades in the gradebook as <em>features</em> and then use these to find <em>clusters</em> of students. These clusters might represent…</p>
<ul>
<li class="fragment">people who studied together</li>
<li class="fragment">people who are in the same section</li>
<li class="fragment">people who have the same major or background</li>
<li class="fragment">… or none of the above!</li>
</ul></li>
</ul>
</div>
</section>
<section id="applications-for-clustering" class="slide level2">
<h2>Applications for Clustering</h2>
<div class="midi">
<ul>
<li class="fragment"><p><strong>Ecology:</strong> An ecologist wants to group organisms into types to define different species. <em>(rows = organisms; features = habitat, size, etc.)</em></p></li>
<li class="fragment"><p><strong>Biology:</strong> A geneticist wants to know which groups of genes tend to be activated at the same time. <em>(rows = genes; features = activation at certain times)</em></p></li>
<li class="fragment"><p><strong>Market Segmentation:</strong> A business wants to group their customers into types. <em>(rows = customers, features = age, location, etc.)</em></p></li>
<li class="fragment"><p><strong>Language:</strong> A linguist might want to identify different uses of ambiguous words like “set” or “run”. <em>(rows = words; features = other words they are used with)</em></p></li>
<li class="fragment"><p><strong>Documents:</strong> A historian might want to find groups of articles that are on similar topics. <em>(rows = articles; features = tf-idf transformed n-grams)</em></p></li>
</ul>
</div>
</section></section>
<section>
<section id="k-means" class="title-slide slide level1 center">
<h1>K-Means</h1>

</section>
<section id="the-k-means-algorithm" class="slide level2">
<h2>The K-Means Algorithm</h2>
<blockquote>
<p><strong>Idea:</strong> Two observations are <em>similar</em> if they are <em>close</em> in distance.</p>
</blockquote>
<div class="centered">
<p>Does this sound familiar?!</p>
</div>
<div class="fragment">
<p><br></p>
<p><strong>Q: How do we find “groups” of observations?</strong></p>
<p>A: We should look for groups of observations that are close to the same <strong>centroid</strong>.</p>
</div>
</section>
<section id="the-k-means-algorithm-1" class="slide level2">
<h2>The K-Means Algorithm</h2>
<p><strong>Procedure (3-means):</strong></p>
<ol type="1">
<li class="fragment"><p>Choose 3 random observations to be the <strong>initial centroids</strong>.</p></li>
<li class="fragment"><p>For each observation, determine which is the <strong>closest centroid</strong>.</p></li>
<li class="fragment"><p>Create 3 <strong>clusters</strong> based on the closest centroid.</p></li>
<li class="fragment"><p>Find the <strong>new centroid</strong> of each cluster.</p></li>
<li class="fragment"><p>Repeat until the clusters don’t change.</p></li>
</ol>
<div class="fragment">
<p><a href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/" class="uri">https://www.naftaliharris.com/blog/visualizing-k-means-clustering/</a></p>
</div>
</section>
<section id="example-penguin-data" class="slide level2">
<h2>Example: Penguin Data</h2>
<div class="small">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a>df_penguins <span class="op">=</span> pd.read_csv(<span class="st">"https://dlsun.github.io/stats112/data/penguins.csv"</span>)</span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>df_penguins</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       species     island  bill_length_mm  ...  body_mass_g     sex  year
0       Adelie  Torgersen            39.1  ...       3750.0    male  2007
1       Adelie  Torgersen            39.5  ...       3800.0  female  2007
2       Adelie  Torgersen            40.3  ...       3250.0  female  2007
3       Adelie  Torgersen             NaN  ...          NaN     NaN  2007
4       Adelie  Torgersen            36.7  ...       3450.0  female  2007
..         ...        ...             ...  ...          ...     ...   ...
339  Chinstrap      Dream            55.8  ...       4000.0    male  2009
340  Chinstrap      Dream            43.5  ...       3400.0  female  2009
341  Chinstrap      Dream            49.6  ...       3775.0    male  2009
342  Chinstrap      Dream            50.8  ...       4100.0    male  2009
343  Chinstrap      Dream            50.2  ...       3775.0  female  2009

[344 rows x 8 columns]</code></pre>
</div>
</div>
</div>
</section>
<section id="penguin-data-investigating-missing-values" class="slide level2">
<h2>Penguin Data: Investigating Missing Values</h2>
<p>It looks like there are missing values in these data…</p>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a>df_penguins.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 344 entries, 0 to 343
Data columns (total 8 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   species            344 non-null    object 
 1   island             344 non-null    object 
 2   bill_length_mm     342 non-null    float64
 3   bill_depth_mm      342 non-null    float64
 4   flipper_length_mm  342 non-null    float64
 5   body_mass_g        342 non-null    float64
 6   sex                333 non-null    object 
 7   year               344 non-null    int64  
dtypes: float64(4), int64(1), object(3)
memory usage: 21.6+ KB</code></pre>
</div>
</div>
</div>
</section>
<section id="penguin-data-removing-missing-values" class="slide level2">
<h2>Penguin Data: Removing Missing Values</h2>
<p>For this analysis, we are interested in a penguin’s bill length and flipper length, so I will remove the missing values from those columns.</p>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a>df_penguins <span class="op">=</span> (</span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a>  df_penguins</span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a>  .dropna(subset <span class="op">=</span> [<span class="st">"bill_length_mm"</span>, <span class="st">"flipper_length_mm"</span>])</span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="penguin-data-plot" class="slide level2">
<h2>Penguin Data: Plot</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a>  ggplot(data <span class="op">=</span> df_penguins, </span>
<span id="cb6-3"><a aria-hidden="true" tabindex="-1"></a>         mapping <span class="op">=</span> aes(x <span class="op">=</span> <span class="st">"bill_length_mm"</span>, y <span class="op">=</span> <span class="st">"flipper_length_mm"</span>)) <span class="op">+</span> </span>
<span id="cb6-4"><a aria-hidden="true" tabindex="-1"></a>         geom_point() <span class="op">+</span> </span>
<span id="cb6-5"><a aria-hidden="true" tabindex="-1"></a>         theme_bw() <span class="op">+</span></span>
<span id="cb6-6"><a aria-hidden="true" tabindex="-1"></a>         labs(x <span class="op">=</span> <span class="st">"Bill Length (mm)"</span>, </span>
<span id="cb6-7"><a aria-hidden="true" tabindex="-1"></a>              y <span class="op">=</span> <span class="st">"Flipper Length (mm)"</span></span>
<span id="cb6-8"><a aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb6-9"><a aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>

<img data-src="13-kmeans_files/figure-revealjs/bill-length-flipper-length-plot-1.png" class="quarto-figure quarto-figure-center r-stretch" width="614"></section>
<section id="step-0-standardize-the-data" class="slide level2">
<h2>Step 0: Standardize the data</h2>
<div class="fragment">
<p><br> <br></p>
<div class="centered">
<div class="large">
<p>Why is this important?</p>
</div>
</div>
</div>
</section>
<section id="step-0-standardize-the-data-1" class="slide level2">
<h2>Step 0: Standardize the data</h2>
<p><strong>Specify</strong></p>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler().set_output(transform <span class="op">=</span> <span class="st">"pandas"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<p><strong>Fit &amp; Transform</strong></p>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>df_scaled <span class="op">=</span> (</span>
<span id="cb8-2"><a aria-hidden="true" tabindex="-1"></a>  scaler</span>
<span id="cb8-3"><a aria-hidden="true" tabindex="-1"></a>  .fit_transform(df_penguins[[<span class="st">"bill_length_mm"</span>, <span class="st">"flipper_length_mm"</span>]])</span>
<span id="cb8-4"><a aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a aria-hidden="true" tabindex="-1"></a>df_scaled.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   bill_length_mm  flipper_length_mm
0       -0.884499          -1.418347
1       -0.811126          -1.062250
2       -0.664380          -0.421277
4       -1.324737          -0.563715
5       -0.847812          -0.777373</code></pre>
</div>
</div>
</div>
</section>
<section id="step-1-choose-3-random-points-to-be-centroids" class="slide level2">
<h2>Step 1: Choose 3 random points to be centroids</h2>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> df_scaled.sample(n <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">1234</span>)</span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>centroids.index <span class="op">=</span> [<span class="st">"orange"</span>, <span class="st">"purple"</span>, <span class="st">"green"</span>]</span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a>centroids</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        bill_length_mm  flipper_length_mm
orange       -0.425917          -0.634935
purple        0.674678          -0.421277
green        -0.077396           0.860670</code></pre>
</div>
</div>
</div>
</section>
<section id="step-1-choose-3-random-points-to-be-centroids-1" class="slide level2">
<h2>Step 1: Choose 3 random points to be centroids</h2>
<div class="midi">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a>  ggplot(data <span class="op">=</span> df_scaled, </span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a>         mapping <span class="op">=</span> aes(x <span class="op">=</span> <span class="st">"bill_length_mm"</span>, y <span class="op">=</span> <span class="st">"flipper_length_mm"</span>)) <span class="op">+</span> </span>
<span id="cb12-4"><a aria-hidden="true" tabindex="-1"></a>         geom_point() <span class="op">+</span> </span>
<span id="cb12-5"><a aria-hidden="true" tabindex="-1"></a>         geom_point(data <span class="op">=</span> centroids, color <span class="op">=</span> centroids.index, size <span class="op">=</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb12-6"><a aria-hidden="true" tabindex="-1"></a>         theme_bw() <span class="op">+</span></span>
<span id="cb12-7"><a aria-hidden="true" tabindex="-1"></a>         labs(x <span class="op">=</span> <span class="st">"Bill Length (mm)"</span>, </span>
<span id="cb12-8"><a aria-hidden="true" tabindex="-1"></a>              y <span class="op">=</span> <span class="st">"Flipper Length (mm)"</span></span>
<span id="cb12-9"><a aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb12-10"><a aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>

<img data-src="13-kmeans_files/figure-revealjs/add-centroids-to-plot-3.png" class="quarto-figure quarto-figure-center r-stretch" width="614"></section>
<section id="step-2-assign-each-point-to-nearest-centroid" class="slide level2">
<h2>Step 2: Assign each point to nearest centroid</h2>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> pairwise_distances</span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>dists <span class="op">=</span> pairwise_distances(df_scaled, centroids)</span>
<span id="cb13-4"><a aria-hidden="true" tabindex="-1"></a>dists[<span class="dv">1</span>:<span class="dv">5</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[0.57531222, 1.61816529, 2.0581506 ],
       [0.32017798, 1.3390574 , 1.40994282],
       [0.90163652, 2.00448173, 1.89333953],
       [0.44529088, 1.5635793 , 1.8101736 ]])</code></pre>
</div>
</div>
</div>
</section>
<section id="step-2-assign-each-point-to-nearest-centroid-1" class="slide level2">
<h2>Step 2: Assign each point to nearest centroid</h2>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a>closest_centroid <span class="op">=</span> dists.argmin(axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a>closest_centroid</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1,
       1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 0, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1])</code></pre>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><code>axis = 1</code> operates on each row</strong></p>
</div>
<div class="callout-content">

</div>
</div>
</div>
</section>
<section id="step-2-assign-each-point-to-nearest-centroid-2" class="slide level2">
<h2>Step 2: Assign each point to nearest centroid</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a>df_scaled.index <span class="op">=</span> centroids.index[closest_centroid]</span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>df_scaled.head(n <span class="op">=</span> <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        bill_length_mm  flipper_length_mm
orange       -0.884499          -1.418347
orange       -0.811126          -1.062250
orange       -0.664380          -0.421277
orange       -1.324737          -0.563715
orange       -0.847812          -0.777373
orange       -0.921185          -1.418347
orange       -0.866155          -0.421277
orange       -1.801661          -0.563715
orange       -0.352544          -0.777373
orange       -1.122961          -1.062250</code></pre>
</div>
</div>
</section>
<section id="step-2-assign-each-point-to-nearest-centroid-3" class="slide level2">
<h2>Step 2: Assign each point to nearest centroid</h2>
<div class="midi">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a>  ggplot(data <span class="op">=</span> df_scaled, </span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a>         mapping <span class="op">=</span> aes(x <span class="op">=</span> <span class="st">"bill_length_mm"</span>, y <span class="op">=</span> <span class="st">"flipper_length_mm"</span>)) <span class="op">+</span> </span>
<span id="cb19-4"><a aria-hidden="true" tabindex="-1"></a>         geom_point(color <span class="op">=</span> df_scaled.index) <span class="op">+</span> </span>
<span id="cb19-5"><a aria-hidden="true" tabindex="-1"></a>         geom_point(data <span class="op">=</span> centroids, color <span class="op">=</span> centroids.index, size <span class="op">=</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb19-6"><a aria-hidden="true" tabindex="-1"></a>         theme_bw() <span class="op">+</span></span>
<span id="cb19-7"><a aria-hidden="true" tabindex="-1"></a>         labs(x <span class="op">=</span> <span class="st">"Bill Length (mm)"</span>, </span>
<span id="cb19-8"><a aria-hidden="true" tabindex="-1"></a>              y <span class="op">=</span> <span class="st">"Flipper Length (mm)"</span></span>
<span id="cb19-9"><a aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb19-10"><a aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>

<img data-src="13-kmeans_files/figure-revealjs/assign-points-to-centroids-plot-5.png" class="quarto-figure quarto-figure-center r-stretch" width="614"></section>
<section id="step-3-find-new-centroids" class="slide level2">
<h2>Step 3: Find new centroids</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> df_scaled.groupby(df_scaled.index).mean()</span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a>centroids</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        bill_length_mm  flipper_length_mm
green         0.628892           1.140501
orange       -0.957138          -0.821529
purple        0.980022          -0.332526</code></pre>
</div>
</div>
<div class="fragment">
<p><br></p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Are these centroids observations in <code>df_scaled</code>?</p>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-find-new-centroids-1" class="slide level2">
<h2>Step 3: Find new centroids</h2>
<div class="midi">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>  ggplot(data <span class="op">=</span> df_scaled, </span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a>         mapping <span class="op">=</span> aes(x <span class="op">=</span> <span class="st">"bill_length_mm"</span>, y <span class="op">=</span> <span class="st">"flipper_length_mm"</span>)) <span class="op">+</span> </span>
<span id="cb22-4"><a aria-hidden="true" tabindex="-1"></a>         geom_point(color <span class="op">=</span> df_scaled.index) <span class="op">+</span> </span>
<span id="cb22-5"><a aria-hidden="true" tabindex="-1"></a>         geom_point(data <span class="op">=</span> centroids, color <span class="op">=</span> centroids.index, size <span class="op">=</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb22-6"><a aria-hidden="true" tabindex="-1"></a>         theme_bw() <span class="op">+</span></span>
<span id="cb22-7"><a aria-hidden="true" tabindex="-1"></a>         labs(x <span class="op">=</span> <span class="st">"Bill Length (mm)"</span>, </span>
<span id="cb22-8"><a aria-hidden="true" tabindex="-1"></a>              y <span class="op">=</span> <span class="st">"Flipper Length (mm)"</span></span>
<span id="cb22-9"><a aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb22-10"><a aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>

<img data-src="13-kmeans_files/figure-revealjs/assign-points-to-new-centroids-plot-7.png" class="quarto-figure quarto-figure-center r-stretch" width="614"></section>
<section id="step-4-repeat-over-and-over" class="slide level2">
<h2>Step 4: Repeat over and over!</h2>
<div class="small">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">6</span>):</span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a>  dists <span class="op">=</span> pairwise_distances(df_scaled, centroids)</span>
<span id="cb23-3"><a aria-hidden="true" tabindex="-1"></a>  closest_centroid <span class="op">=</span> dists.argmin(axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb23-4"><a aria-hidden="true" tabindex="-1"></a>  df_scaled.index <span class="op">=</span> centroids.index[closest_centroid]</span>
<span id="cb23-5"><a aria-hidden="true" tabindex="-1"></a>  centroids <span class="op">=</span> df_scaled.groupby(df_scaled.index).mean()</span>
<span id="cb23-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(centroids)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        bill_length_mm  flipper_length_mm
green         0.656908           1.142766
orange       -0.960807          -0.817256
purple        0.938075          -0.370088
        bill_length_mm  flipper_length_mm
green         0.666589           1.147791
orange       -0.958236          -0.808502
purple        0.938075          -0.370088
        bill_length_mm  flipper_length_mm
green         0.666589           1.147791
orange       -0.958236          -0.808502
purple        0.938075          -0.370088
        bill_length_mm  flipper_length_mm
green         0.666589           1.147791
orange       -0.958236          -0.808502
purple        0.938075          -0.370088
        bill_length_mm  flipper_length_mm
green         0.666589           1.147791
orange       -0.958236          -0.808502
purple        0.938075          -0.370088</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="small">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>At what point do we stop finding new centroids / reassigning points?</strong></p>
</div>
<div class="callout-content">

</div>
</div>
</div>
</div>
</div>
</section>
<section id="k-means-in-sklearn" class="slide level2">
<h2>K-means in sklearn</h2>
<p><strong>Specify</strong></p>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb25-2"><a aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb25-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">"bill_length_mm"</span>, <span class="st">"flipper_length_mm"</span>]</span>
<span id="cb25-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">1234</span>)</span>
<span id="cb25-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> make_pipeline(</span>
<span id="cb25-9"><a aria-hidden="true" tabindex="-1"></a>    StandardScaler(),</span>
<span id="cb25-10"><a aria-hidden="true" tabindex="-1"></a>    model</span>
<span id="cb25-11"><a aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<p><strong>Fit</strong></p>
<div class="midi">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a>pipeline.fit(df_penguins[features])<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="k-means-in-sklearn-1" class="slide level2">
<h2>K-means in sklearn</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a aria-hidden="true" tabindex="-1"></a>clusters <span class="op">=</span> model.labels_</span>
<span id="cb27-2"><a aria-hidden="true" tabindex="-1"></a>clusters</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0, 2,
       2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 0, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2], dtype=int32)</code></pre>
</div>
</div>
</section>
<section id="interpreting-k-means" class="slide level2">
<h2>Interpreting K-Means</h2>
<p>The key takeaway here is the <strong>cluster centers</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> model.cluster_centers_</span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a>centroids</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[-0.95823619, -0.80850204],
       [ 0.66658932,  1.14779076],
       [ 0.93807532, -0.37008779]])</code></pre>
</div>
</div>
<!-- "bill_length_mm", "flipper_length_mm" -->
<ul>
<li class="fragment"><p>Cluster 1 has a short bill and short flippers</p></li>
<li class="fragment"><p>Cluster 2 has medium bill and long flipper</p></li>
<li class="fragment"><p>Cluster 3 has long bill, and fairly average flipper</p></li>
</ul>
</section>
<section id="interpreting-k-means-1" class="slide level2">
<h2>Interpreting K-Means</h2>
<p>We also might check if these clusters match any labels that we already know:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb31-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"cluster"</span>: clusters,</span>
<span id="cb31-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"species"</span>: df_penguins[<span class="st">'species'</span>]</span>
<span id="cb31-4"><a aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb31-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb31-7"><a aria-hidden="true" tabindex="-1"></a>  results</span>
<span id="cb31-8"><a aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">"species"</span>)[<span class="st">"cluster"</span>]</span>
<span id="cb31-9"><a aria-hidden="true" tabindex="-1"></a>  .value_counts()</span>
<span id="cb31-10"><a aria-hidden="true" tabindex="-1"></a>  .unstack()</span>
<span id="cb31-11"><a aria-hidden="true" tabindex="-1"></a>  .fillna(<span class="dv">0</span>)</span>
<span id="cb31-12"><a aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cluster        0      1     2
species                      
Adelie     146.0    1.0   4.0
Chinstrap    5.0    4.0  59.0
Gentoo       0.0  122.0   1.0</code></pre>
</div>
</div>
</section></section>
<section>
<section id="your-turn" class="title-slide slide level1 center">
<h1>Your Turn</h1>

</section>
<section id="activity" class="slide level2">
<h2>Activity</h2>
<ol type="1">
<li>Fit a 3-means model using <em>all</em> the numeric predictors in the penguins data.</li>
</ol>
<ul>
<li><p>Describe what each cluster represents.</p></li>
<li><p>Do these clusters match up to the species?</p></li>
</ul>
<ol start="2" type="1">
<li>Next, fit a 5-means model.</li>
</ol>
<ul>
<li>Do those clusters match up to species and island?</li>
</ul>
</section></section>
<section>
<section id="takeaways" class="title-slide slide level1 center">
<h1>Takeaways</h1>

</section>
<section id="takeaways-1" class="slide level2">
<h2>Takeaways</h2>
<ul>
<li><p><strong>Unsupervised learning</strong> is a way to find <em>structure</em> in data.</p></li>
<li><p><strong>K-means</strong> is the most common <strong>clustering method</strong>.</p></li>
<li><p>We <strong>have to choose K ahead of time</strong>.</p></li>
</ul>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>This is a big problem!</strong></p>
</div>
<div class="callout-content">
<p>Why can’t we tune????</p>
</div>
</div>
</div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/github\.com\/atheobold\/data-301");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>